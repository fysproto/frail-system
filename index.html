<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>フレイル測定</title>
</head>
<body>

  <!-- Q1 -->
  <div id="q1">
    <p>Q12：外出頻度</p>
    <select id="Q12">
      <option value="">選択</option>
      <option value="月１以上">月１以上</option>
      <option value="月１未満">月１未満</option>
    </select>
    <br><br>
    <button onclick="go(2)">次へ</button>
  </div>

  <!-- Q2 -->
  <div id="q2" style="display:none">
    <p>Q7：体重は減りましたか</p>
    <select id="q7">
      <option value="">選択</option>
      <option value="はい">はい</option>
      <option value="いいえ">いいえ</option>
    </select>
    <br><br>
    <button onclick="go(3)">次へ</button>
  </div>

  <!-- Q3 -->
  <div id="q3" style="display:none">
    <p>握力</p>
    <input type="number" id="GRIP">
    <p>BMI</p>
    <input type="number" id="bmi">
    <br><br>
    <button onclick="finish()">次へ</button>
  </div>

<script>
  function go(n) {
    document.getElementById("q1").style.display = "none";
    document.getElementById("q2").style.display = "none";
    document.getElementById("q3").style.display = "none";
    document.getElementById("q" + n).style.display = "block";
  }

  function finish() {
    const result = {
      Q12: document.getElementById("Q12").value,
      q7: document.getElementById("q7").value,
      GRIP: document.getElementById("GRIP").value,
      bmi: document.getElementById("bmi").value,
      is_done: true
    };

    // ★ 変更点はここだけ（2行）
    const payload = encodeURIComponent(JSON.stringify(result));
    window.location.href = `/?done=1&data=${payload}`;
  }
</script>

</body>
</html>
